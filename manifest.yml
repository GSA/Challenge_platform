---
defaults: &defaults
  buildpacks:
    - https://github.com/cloudfoundry/apt-buildpack
    - nodejs_buildpack
    - ruby_buildpack
  memory: 1G
  disk_quota: 2G
  stack: cflinuxfs4
  health-check-type: process
  command: ./cloud_start.sh

applications:
- name: challenge-dev
  <<: *defaults
  instances: 1
  disk_quota: 6GB
  env:
    RAILS_ENV: dev
    RAILS_LOG_TO_STDOUT: true
    RAILS_SERVE_STATIC_FILES: true
    HOST: challenge-dev.app.cloud.gov
    LOGIN_PRIVATE_KEY_PATH: dev_key.pem
    LOGIN_PUBLIC_KEY_PATH: dev_cert.pem
    LOGIN_REDIRECT_URL: https://challenge-portal-dev.app.cloud.gov/auth/result
    LOGIN_IDP_AUTHORIZE_URL: https://idp.int.identitysandbox.gov/openid_connect/authorize
    LOGIN_TOKEN_ENDPOINT: https://idp.int.identitysandbox.gov/api/openid_connect/token
    LOGIN_CLIENT_ID: urn:gov:gsa:openidconnect.profiles:sp:sso:gsa:challenge_gov_portal_dev
